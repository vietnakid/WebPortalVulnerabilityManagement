{% extends "index.html" %}

{% block body %}
<div class="container-fluid">

    <!-- Page Heading -->
    <h1 class="h2 mb-4 text-gray-800">{{response.name}}</h1>
    <div style="margin-bottom: 1rem">
        <span class="acu-detail" style="background: {{response.crit_color}}">{{response.crit_label}}</span>
        <span class="acu-detail" style="background: grey">{{response.status}}</span>
    </div>

    <!-- Vulnerable description -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-1" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-1">
                    <h5 class="m-0 font-weight-bold text-primary">Vulnerable description</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-1">
                    <div class="card-body">
                        {{response.description}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Attack detail -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-2" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-2">
                    <h5 class="m-0 font-weight-bold text-primary">Attack Detail</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-2">
                    <div class="card-body">
                        {{attack}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HTTP Request -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-3" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-3">
                    <h5 class="m-0 font-weight-bold text-primary">HTTP Request</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-3">
                    <div class="card-body">
                        {{response.http_request}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HTTP Resonpe -->

    <!-- <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <a href="#card-4" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-4">
                    <h5 class="m-0 font-weight-bold text-primary">HTTP Response</h5>
                </a>
                <div class="collapse show" id="card-4">
                    <div class="card-body">
                        {{response.http_response}}
                    </div>
                </div>
            </div>
        </div>
    </div> -->

    <!-- The impact of this vulnerability -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-5" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-5">
                    <h5 class="m-0 font-weight-bold text-primary">The impact of this vulnerability</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-5">
                    <div class="card-body">
                        {{response.impact}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- How to fix this vulnerability -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-6" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-6">
                    <h5 class="m-0 font-weight-bold text-primary">How to fix this vulnerability</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-6">
                    <div class="card-body">
                        {{response.how_to_fix}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Classification -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-7" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-7">
                    <h5 class="m-0 font-weight-bold text-primary">Classification</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-7">
                    <div class="card-body">
                        <b style="color: red">CWE: </b>
                        {% for cwe in response.cwe %}
                        <span>{{cwe}}</span>
                        {% endfor %}
                        <br>

                        <b style="color: red">CVSS: </b>
                        <p>CVSS2: {{response.cvss2}}</p>
                        <p>CVSS3: {{response.cvss3}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Detailed information -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-8" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-8">
                    <h5 class="m-0 font-weight-bold text-primary">Detailed Information</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-8">
                    <div class="card-body">
                        {{response.detailed_info}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Web reference -->
    <div class="row">
        <div class="col-lg-9">
            <div class="card shadow mb-4">
                <!-- Card Header - Accordion -->
                <a href="#card-9" class="d-block card-header py-3" data-toggle="collapse" role="button"
                    aria-expanded="true" aria-controls="card-9">
                    <h5 class="m-0 font-weight-bold text-primary">Web reference</h5>
                </a>
                <!-- Card Content - Collapse -->
                <div class="collapse show" id="card-9">
                    <div class="card-body">
                        {% for ref in response.references %}
                        <p>
                            <a href={{ref.href}}> {{ref.rel}} </a>
                        </p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% endblock %}