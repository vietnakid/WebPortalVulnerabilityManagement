{% extends "index.html" %}

{% block body %}
<h2>Scan result:</h2>
<br>

<form method="GET" action="overview">
    <input type="text" name="q" placeholder="Search..." value="{{search_query}}" />
    <button type="submit">Search</button>
</form>

{% if search_query != '' %}
<h3>
    <i>
        Showing search result for: "<span style="color: crimson">{{search_query}}</span>"
    </i>
</h3>
{% endif %}

<p><b>Total: {{response.total}} </b></p>

<div>
    Sort by:
    <select id="sort">
        <option value="1" {% if sorting == "scanstat.startTime:desc" %} selected="selected" {% endif %}>Init time desc
        </option>
        <option value="2" {% if sorting == "scanstat.startTime:asc" %} selected="selected" {% endif %}>Init time asc
        </option>
    </select>
</div>
<br>

<table style="width:75%">
    <tr>
        <th>#</th>
        <th>Root Scan ID</th>
        <th>Target</th>
        <th>Created Date</th>
        <th>Next Run At</th>
        <th>Run Interval</th>
        <th>Scan Type</th>
        <th>Scanned Times</th>
        <th>Sumary Result</th>
    </tr>

    {% for item in response.records %}
    <tr>
        <td> {{loop.index}} </td>
        <td> <a href="detail/{{item.id}}"> {{item.id}} </td>
        <td> {{item.target}} </td>
        <td> {{item.created_date}} </td>
        <td> {{item.next_run_at}} </td>
        <td> {{item.run_interval}} </td>
        <td> {{item.scan_type}} </td>
        <td> {{item.scanned_time}} </td>
        <td>
            <span class="vul" style="background: blue"> {{item.summary_result.informational}} </span>
            <span class="vul" style="background: green"> {{item.summary_result.low}} </span>
            <span class="vul" style="background: orange"> {{item.summary_result.medium}} </span>
            <span class="vul" style="background: red"> {{item.summary_result.high}} </span>
        </td>
    </tr>
    {% endfor %}


</table>
{%endblock%}