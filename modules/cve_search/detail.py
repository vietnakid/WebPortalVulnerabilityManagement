# Import from standard library
import logging
from datetime import datetime

# Import from third-party
from flask import Flask, render_template, json, request, jsonify

# Import local files
import DAO.db_connect as db_connect
from config.config import ElasticConfig
from modules.cve_search.process_cve import processCVE, processCveDetail

def cve_detail():
    cId = request.args.get('id')
    try:
        es = db_connect.connect_elasticsearch()
        try:
            body = {"query": {"match": {
                "_id": cId}}}
            rawData = es.search(
                index=ElasticConfig.CVESEARCH_INDEX, body=body,)
            print(rawData)
            processed_data = processCveDetail(rawData)
            return render_template('cve-detail.html', response=processed_data, seg=1)
        except:
            logging.exception(msg="Fail")
    except:
        logging.exception(msg="Fail")