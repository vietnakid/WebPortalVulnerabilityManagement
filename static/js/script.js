$(document).ready(function () {

    $('#MyForm').on('submit', function (event) {
        event.preventDefault();
        $.ajax({
            url: '/register',
            data: {
                name: $('#nameInput').val(),
                email: $('#emailInput').val(),
            },
            type: 'POST',
            success: function (response) {
                console.log(response)
            },
            error: function (error) {
                console.log(error)
            }
        })
            .done(function (data) {
                if (data.error) {
                    console.log(data.error)
                } else {
                    console.log(data.name)
                }
            });
    });

    function isValidIP(stringIP) {
        var ipRegex = /^(?!0)(?!.*\.$)((1?\d?\d|25[0-5]|2[0-4]\d)(\.|$)){4}$/g;
        if (stringIP.match(ipRegex) !== null) {
            return true;
        } else {
            return false;
        }
    }

    $('#btnSubmit').click(function () {
        if ($('#name').val() === "") {
            $('#noti').text("Please input scan Name!");
            $('#noti').show();
            return false;
        }
        if (!$('#nmap').prop('checked') && !$('#nesus').prop('checked') && !$('#accunetix').prop('checked')) {
            $('#noti').text("Please select at least 1 scan type!");
            $('#noti').show();
            return false;
        }
        if (isValidIP($('#target').val()) === false) {
            $('#noti').text("Please enter a valid ip address!");
            $('#noti').show();
            return false;
        }

        var stringTools = ""
        if ($('#nmap').prop('checked')) {
            stringTools += 1;
        }
        if ($('#nesus').prop('checked')) {
            stringTools += 2;
        }
        if ($('#accunetix').prop('checked')) {
            stringTools += 3;
        }
        $('#stringTools').val(stringTools);
        $('#noti').text("");
        $('#noti').hide();
        $("#scanForm").submit()
    })

    $('#sort').change(function(){
        changeValue = parseInt($(this).val());
        currentURL = document.location.href;
        sortInitDesc = "init_desc";
        sortInitAsc = "init_asc";
      
        if(currentURL.includes(sortInitDesc) && changeValue === 1 
            || !currentURL.includes("sort") && changeValue === 1
            || currentURL.includes(sortInitAsc) && changeValue === 2){
            return;
        }else{
            toBeSort = changeValue === 1 ? sortInitDesc : sortInitAsc;
            url = new URL(currentURL);
            url.searchParams.set('sort', toBeSort);
            window.location.href = url;
            return;
        }
    })








});