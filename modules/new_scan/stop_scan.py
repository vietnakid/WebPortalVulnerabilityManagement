# Import from standard library
import logging, json, re
# from datetime import datetime

# Import from third-party
from flask import Flask, render_template, request, session, redirect, url_for

# Import local files
import DAO.db_connect as db_connect
from config.config import ElasticConfig

def stop_scan():
    try:
        es = db_connect.connect_elasticsearch()
        scanId = request.form.get('scanId')    
        es.update(index=ElasticConfig.SCAN_INDEX, doc_type='_doc', id=scanId, body={"doc": {"isStopped": True}})
    except:
        logging.exception(msg="Connect database failed!")
    return redirect(url_for('scan_overview'))
