<!DOCTYPE html>
<html lang="en">

<head>
    <title>Nmap demo</title>
    <style>
        table,
        th,
        td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 5px;
        }
        
        body {
            margin-left: 50px;
        }
    </style>
</head>

<body>

    <h2>Demo NSE detail:</h2>

    <h3>Total: {{response.total}}</h3>

    <h3>Common data:</h3>

    <div>
        <label>Target:</label> {{response.source.target}}
    </div>

    <div>
        <label>Host name:</label> {{response.source.hostname}}
    </div>

    <div>
        <label>Status:</label> {{response.source.status}}
    </div>

    <div>
        <label>Init time:</label> {{response.source.init_time}}
    </div>

    <div>
        <label>Scan time:</label> {{response.source.scan_time}}
    </div>

    <h3>NSE info:</h3>

    <table style="width:75%">
        <tr>
            <th>Port</th>
            <th>NSE Script</th>
            <th>Output</th>
        </tr>

        {% for k, v in response.source.nse.items() %} 
            <tr>
                <td rowspan={{v|length + 1}}> {{k}} </td>
                    {% for key, value in v.items() %}
                    <tr>
                        <td> {{key}} </td>
                        <td> {{value}} </td>                            
                    </tr>
                    {% endfor %} 
            </tr>
        {% endfor %}

    </table>

</body>

</html>