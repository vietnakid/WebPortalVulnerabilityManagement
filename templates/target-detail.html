{% extends "index.html" %}

{% block body %}
<div class="container-fluid">
    <!-- Page Heading -->
    <h1 class="h2 mb-4 text-gray-800">Target detail:</h1>
    <!-- Common data -->
    <div class="row">
        <div class="col-lg-6" style="padding-left: 0">
            <div class="card shadow mb-4">
                <!-- Header -->
                <div class="card-header py-3">
                    <h4 class="m-0 font-weight-bold text-primary">Common data:</h4>
                </div>
                <!-- End Header -->

                <!-- Body -->
                <div class="card-body">
                    <div class="form-group row" style="background: aliceblue">
                        <label>IP target:</label>
                        <div class="col-sm-7 common-data">
                            {{nmapData.target}} </div>
                    </div>

                    <div class="form-group row">
                        <label>Hostname:</label>
                        <div class="col-sm-7 common-data">
                            {{nmapData.hostname}} </div>
                    </div>

                    <div class="form-group row" style="background: aliceblue">
                        <label>Status:</label>
                        <div class="col-sm-7 common-data" style="color: {%if nmapData.status == "UP"%} green {%else%} red {%endif%}">
                            {{nmapData.status}} </div>
                    </div>

                    <div class="form-group row">
                        <label>Scan ID:</label>
                        <div class="col-sm-7 common-data">
                            <a href="/scan/detail/{{nmapData.root_scan_id}}">{{nmapData.scan_id}}</a> </div>
                    </div>

                    <div class="form-group row" style="background: aliceblue">
                        <label>Scan Name:</label>
                        <div class="col-sm-7 common-data">
                            {{nmapData.scan_name}} </div>
                    </div>

                    <div class="form-group row">
                        <label>Init Time:</label>
                        <div class="col-sm-7 common-data">
                            {{nmapData.init_time}} </div>
                    </div>
                </div>
                <!-- End Body -->

            </div>
        </div>
    </div>
    <!-- End Common data -->

    <!-- Detailed table data -->
    <div class="row">
        <div class="card shadow mb-4">
            <!-- Header -->
            <div class="card-header py-3">
                <h4 class="m-0 font-weight-bold text-primary">Scanning results:</h4>
            </div>
            <!-- Header -->

            <div class="card-body">
                <div class="table-responsive">
                    <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
                        <!-- Horizontal nav display tool's names -->
                        <ul class="nav nav-pills mb-3 nav-fill" id="nav-target" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="nmap-tab" data-toggle="pill" href="#nmap" role="tab" aria-controls="nmap" aria-selected="true">Nmap</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="wappalyzer-tab" data-toggle="pill" href="#wappalyzer" role="tab" aria-controls="wappalyzer" aria-selected="true">Wappalyzer</a>
                                    </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="cvesearch-tab" data-toggle="pill" href="#cvesearch" role="tab" aria-controls="cvesearch" aria-selected="false">CVESearch</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="nikto-tab" data-toggle="pill" href="#nikto" role="tab" aria-controls="nikto" aria-selected="false">Nikto</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="acunetix-tab" data-toggle="pill" href="#acunetix" role="tab" aria-controls="acunetix" aria-selected="false">Acunetix</a>
                                </li>
                                <li class="nav-item">
                                <a class="nav-link" id="nessus-tab" data-toggle="pill" href="#nessus" role="tab" aria-controls="nessus" aria-selected="false">Nessus</a>
                                </li>
                            </ul>
                        <!-- Horizontal nav display tool's names -->

                        <div class="tab-content" id="pills-tabContent">
                            <!-- Nmap -->
                            <div class="tab-pane fade show active" id="nmap" role="tabpanel" aria-labelledby="nmap-tab">
                                <table class="table table-bordered dataTable" id="dataTable" width="100%"
                                    cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                    <!-- Head -->
                                    <thead>
                                        <tr role="row">
                                            <th style="width: 30px">#</th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Port</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">OS_Product_Version</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">CPE</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">NSE Script</th>
                                        </tr>
                                    </thead>
                                    <!-- End Head -->

                                    <!-- Body -->
                                    <tbody>
                                        {% for item in nmapData.openports %}
                                        <tr>
                                            <td> {{loop.index}} </td>
                                            <td> {{item.port}} </td>
                                            <td> {{item.os_product_version}} </td>
                                            <td> {{item.cpe}} </td>
                                            <td>
                                                <table>
                                                    {% for nse_item in item.nseOutput %}
                                                    <tr>
                                                        <td>{{nse_item.script}}</td>
                                                        <td>{{nse_item.output}}</td>
                                                    </tr>
                                                    {% endfor %}
                                                </table>
                                            </td>
                                            
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                    <!-- End Body -->
                                </table>
                            </div>
                            <!-- Nmap -->

                            <!-- Wappalyzer -->
                            <div class="tab-pane fade" id="wappalyzer" role="tabpanel" aria-labelledby="wappalyzer-tab">
                                <table class="table table-bordered dataTable" id="dataTable" width="100%"
                                    cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                    <!-- Head -->
                                    <thead>
                                        <tr role="row">
                                            <th style="width: 30px">#</th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Port</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Path</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">CPE</th>
                                        </tr>
                                    </thead>
                                    <!-- End Head -->
                        
                                    <!-- Body -->
                                    <tbody>
                                        {% for item in wappalyzerData %}
                                        <tr>
                                            <td> {{loop.index}} </td>
                                            <td> {{item.port}} </td>
                                            <td> {{item.path}} </td>
                                            <td> 
                                                {% for application in item.applications %}
                                                    {{application.name}} : {{application.version}} <br>
                                                {% endfor %} 
                                            </td>
                                            
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                    <!-- End Body -->
                                </table>
                            </div>
                            <!-- Wappalyzer -->

                            <!-- CVE Search -->
                            <div class="tab-pane fade" id="cvesearch" role="tabpanel" aria-labelledby="cvesearch-tab">
                                <table class="table table-bordered dataTable" id="dataTable" width="100%"
                                    cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                    <!-- Head -->
                                    <thead>
                                        <tr role="row">
                                            <th style="width: 30px">#</th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Product</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">CWE</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">CVE</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">CVSS Score</th>
                                        </tr>
                                    </thead>
                                    <!-- End Head -->
                            
                                    <!-- Body -->
                                    <tbody>
                                        {% for item in cvesearchData %}
                                        <tr>
                                            <td> {{loop.index}} </td>
                                            <td> {{item.cpe}} </td>
                                            <td> {{item.cwe}} </td>
                                            <td> <a href="{{'https://cve.circl.lu/cve/' + item.cve}}" target="_blank">{{item.cve}}</a> </td>
                                            <td> {{item.cvss}} </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                    <!-- End Body -->
                                </table>
                            </div>
                            <!-- CVE Search -->

                            <!-- Nikto -->
                            <div class="tab-pane fade" id="nikto" role="tabpanel" aria-labelledby="nikto-tab">
                                <table class="table table-bordered dataTable" id="dataTable" width="100%"
                                    cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                    <!-- Head -->
                                    <thead>
                                        <tr role="row">
                                            <th style="width: 30px">#</th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Method</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">URL</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">Message</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">OSVDB</th>
                                        </tr>
                                    </thead>
                                    <!-- End Head -->
                            
                                    <!-- Body -->
                                    <tbody>
                                        {% for item in niktoData %}
                                        <tr>
                                            <td> {{loop.index}} </td>
                                            <td> {{item.method}} </td>
                                            <td> {{item.url}} </td>
                                            <td> {{item.msg}} </td>
                                            <td> {{item.OSVDB}} </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                    <!-- End Body -->
                                </table>
                            </div>
                            <!-- Nikto -->

                            <!-- Acunetix -->
                            <div class="tab-pane fade" id="acunetix" role="tabpanel" aria-labelledby="acunetix-tab">
                                <table class="table table-bordered dataTable" id="dataTable" width="100%"
                                    cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                    <!-- Head -->
                                    <thead>
                                        <tr role="row">
                                            <th style="width: 30px">#</th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Vulnerability</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">URL</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">Parameter</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">CVSS Score</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">Severity</th>
                                        </tr>
                                    </thead>
                                    <!-- End Head -->
                            
                                    <!-- Body -->
                                    <tbody>
                                        {% for item in acunetixData %}
                                        <tr>
                                            <td> {{loop.index}} </td>
                                            <td> <a href = '/acunetix/detail/{{nmapData.scan_id}}/{{item.vuln_id}}'> {{item.vt_name}} </a> </td>
                                            <td> {{item.affects_url}} </td>
                                            <td> {{item.affects_detail}} </td>
                                            <td> {{item.cvss_score}} </td>
                                            <td> {{item.severity}} </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                    <!-- End Body -->
                                </table>
                            </div>
                            <!-- Acunetix -->

                            <!-- Nessus -->
                            <div class="tab-pane fade" id="nessus" role="tabpanel" aria-labelledby="nessus-tab">
                                <table class="table table-bordered dataTable" id="dataTable" width="100%"
                                    cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                    <!-- Head -->
                                    <thead>
                                        <tr role="row">
                                            <th style="width: 30px">#</th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Plugin Name</th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                                colspan="1" style="width: 197px;">Plugin Output</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">Description</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">Solution</th>
                                            <th class="sorting" tabindex="0" aria-Technologies="dataTable" rowspan="1"
                                                colspan="1" style="width: 143px;">CVSS Score</th>
                                        </tr>
                                    </thead>
                                    <!-- End Head -->
                            
                                    <!-- Body -->
                                    <tbody>
                                        {% for item in nessusData %}
                                        <tr>
                                            <td> {{loop.index}} </td>
                                            <td> {{item.pluginname}} </td>
                                            <td> {{item.plugin_output}} </td>
                                            <td> {{item.description}} </td>
                                            <td> {{item.solution}} </td>
                                            <td> {{item.cvss}} </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                    <!-- End Body -->
                                </table>
                            </div>
                            <!-- Nessus -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- End Detailed table data -->
</div>
{%endblock%}