class DashboardQueryBody:
    VIEWROW = 10
    # Vulnerability
    VUL_TOP_CRITICAL = {
        "size": VIEWROW,
        "sort": [{"level": "desc"}],
        "query": {
            "bool": {
                "must": [{"range": {"level": {"gte": 1}}}]
            }
        }
    }

    VUL_TOP_RECENT = {
        "size": VIEWROW,
        "sort": [{"time_scan": "desc"}],
        "query": {
            "bool": {
                "must": [{"range": {"level": {"gte": 1}}}]
            }
        }
    }

    VUL_COUNT = {
        "size": 0,
        "query": {
            "bool": {
                "must": [{"range": {"level": {"gte": 1}}}]
            }
        },
        "aggs": {
            "vuls": {
                "range": {
                    "field": "level",
                    "ranges": [
                        {
                            "key": "low",
                            "from": 1,
                            "to": 3.9
                        },
                        {
                            "key": "medium",
                            "from": 4,
                            "to": 6.9
                        },
                        {
                            "key": "medium-high",
                            "from": 7,
                            "to": 8.9
                        },
                        {
                            "key": "high",
                            "from": 9
                        }
                    ]
                }
            }
        }
    }

    # Target
    TARGET_VUL_COUNT = {
        "size": 0,
        "query": {
            "bool": {
                "must": [{"range": {"level": {"gte": 1}}}]
            }
        },
        "aggs": {
            "targets": {
                "terms": {
                    "field": "target.keyword",
                    "size": 10,
                    "order": {
                        "_count": "desc"
                    }
                }
            }
        }
    }

    TARGET_CRITICAL_COUNT = {
        "size": 0,
        "query": {
            "bool": {
                "must": [{"range": {"level": {"gte": 7}}}]
            }
        },
        "aggs": {
            "targets": {
                "terms": {
                    "field": "target.keyword",
                    "size": 10,
                    "order": {
                        "_count": "desc"
                    }
                }
            }
        }
    }

    VUL_TIMELINE = {
        "aggs": {
            "timeline": {
            "date_histogram": {
                "field": "time_scan",
                "format" : "dd-MM-yyyy HH:mm:SS",
                "interval": "10m",
                "time_zone": "Asia/Saigon",
                "min_doc_count": 1
            }
            }
        },
        "size": 0,
        "_source": {
            "excludes": []
        },
        "stored_fields": [
            "*"
        ],
        "script_fields": {},
        "docvalue_fields": [
            {
            "field": "time_scan",
            "format": "date_time"
            }
        ]
        }
