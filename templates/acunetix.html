<!DOCTYPE html>
<html lang="en">

<head>
    <title>Acunetix demo</title>
    <script src="../static/js/jquery-3.4.1.min.js"></script>
    <script src="../static/js/acunetix.js"></script>
    <style>
        table,
        th,
        td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 5px;
        }
        
        body {
            margin-left: 50px;
        }
        span.vul{
            color: white;
            padding: 7px;
            margin-left: 10px;
            font-weight: bold
        }
    </style>
</head>

<body>
    <h2>Acunetix result:</h2>
    <br>

    <form method="GET" action="overview">
        <input type="text" name="q" placeholder="Search..."/>
        <button type="submit">Search</button>
    </form>

    {% if q != None %}
        <h3>
            <i>
                Showing search result for: "
                <span style="color: crimson">{{q}}</span>"
            </i>
        </h3>
    {% endif %}

    <p><b>Total: {{response.total}} </b></p>

    <div>
        Sort by: 
        <select id="sort">
            <option value="1" {% if sorting == "scanstats.time:desc" %} selected="selected"{% endif %}>Init time desc</option>
            <option value="2" {% if sorting == "scanstats.time:asc" %} selected="selected"{% endif %}>Init time asc</option>
        </select>
    </div>
    <br>

    <table style="width:75%">
        <tr>
            <th>#</th>
            <th>Target</th>
            <th>Hostname</th>
            <th>Init time</th>
            <th>Scan time</th>
            <th>Vulnerabilities</th>
        </tr>

        {% for item in response.records %}
        <tr>
            <td> {{loop.index}} </td>
            <td> <a href="detail/{{item.id}}"> {{item.target}} </td>
            <td> {{item.hostname}} </td>
            <td> {{item.init_time}} </td>
            <td> {{item.scan_time}} </td>
            <td>
                <span class="vul" style="background: blue"> {{item.vuln_stats.informational}} </span>
                <span class="vul" style="background: green"> {{item.vuln_stats.low}} </span>
                <span class="vul" style="background: orange"> {{item.vuln_stats.medium}} </span>
                <span class="vul" style="background: red"> {{item.vuln_stats.high}} </span>
            </td>
        </tr>
        {% endfor %}


    </table>
</body>

</html>