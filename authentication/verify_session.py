from flask import Flask, session
import DAO.db_connect as db_connect
from config.config import ElasticConfig
from DAL import user_dal

import logging
def verify_login():
    if session.get('user') == None or session.get('verified') == False:
        return False
    return True

def verify_user():
    if not verify_login():
        return False
    userid = session['userid']
    if user_dal.check_disabled_user_by_id(userid):
        session.clear()
        return False
    return True

def verify_admin():
    if not verify_login() or session['user']['role'] != 1:
        return False
    userid = session['userid']
    if user_dal.check_disabled_user_by_id(userid):
        session.clear()
        return False
    return True