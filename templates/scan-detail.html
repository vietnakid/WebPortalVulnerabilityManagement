{% extends "index.html" %}

{% block body %}
<h2>Scan detail:</h2>

<form method="GET" action="">
    <input type="text" name="q" placeholder="searching..." value="{{search_query}}" />
    <button type="submit">Search</button>
</form>

{% if search_query != '' %}
<h3>
    <i>
        Showing search result for: "<span style="color: crimson">{{search_query}}</span>"
    </i>
</h3>
{% endif %}

<h3>Common data:</h3>

<div>
    <label>Targets: </label> {{root_scan_data.target}}
</div>

<div>
    <label>next_run_at: </label> {{root_scan_data.next_run_at}}
</div>

<div>
    <label>run_interval: </label> {{root_scan_data.run_interval}}
</div>

<div>
    <label>created_date: </label> {{root_scan_data.created_date}}
</div>

<div>
    <label>scanned_time: </label> {{root_scan_data.scanned_time}}
</div>

<div>
    <label>scan_type: </label> {{root_scan_data.scan_type}}
</div>

<div>
    <label>Total Records:</label> {{response.total}}
</div>

<h3>Targets in this scan info:</h3>

<table style="width:100%">
    <tr>
        <th>#</th>
        <th>Target</th>
        <th>Hostname</th>
        <th>Opened Ports</th>
        <th>Scan ID</th>
        <th>Start At</th>
        <th>Status</th>
        <th>Sumary Result</th>
    </tr>

    {% for item in response.records %}
    <tr>
        <td> {{loop.index}} </td>
        <td> <a href = '/targets/detail/{{item.id}}'> {{item.target}} </a> </td>
        <td> {{item.hostname}} </td>
        <td> {{item.openports}} </td>
        <td> {{item.scan_id}} </td>
        <td> {{item.start_time}} </td>
        <td> doning... </td>
        <td>
            <span class="vul" style="background: blue"> {{item.summary_result.informational}} </span>
            <span class="vul" style="background: green"> {{item.summary_result.low}} </span>
            <span class="vul" style="background: orange"> {{item.summary_result.medium}} </span>
            <span class="vul" style="background: red"> {{item.summary_result.high}} </span>
        </td>
    </tr>
    {% endfor %}


</table>
{%endblock%}