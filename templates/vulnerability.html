{% extends "index.html" %}

{% block body %}
<div class="container-fluid">

    <!-- Page Heading -->
    <h1 class="h2 mb-2 text-gray-800">Vulnerabilities:</h1>

    {% if q != None %}
    <p class="mb-4" style="font-size: 20px"> Showing search result for: "
        <span style="color: crimson; font-style: italic; font-size: 22px">{{q}}</span>" </p>
    {% endif %}


    <!-- DataTales-->
    <div class="card shadow mb-4">
        <div class="card-body">
            <div class="table-responsive">
                <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
                    <!-- Sort -->
                    <div class="row">
                        <div class="col-sm-12 col-md-6">
                            <div class="dataTables_length" id="dataTable_length">
                                <label>Sort by
                                    <select id="sort" name="dataTable_length" aria-controls="dataTable"
                                        class="custom-select custom-select-sm form-control form-control-sm">
                                        <option value="1" {% if sorting == "scanstat.startTime:desc" %}
                                            selected="selected" {% endif %}>
                                            Init time desc </option>
                                        <option value="2" {% if sorting == "scanstat.startTime:asc" %}
                                            selected="selected" {% endif %}>
                                            Init time asc </option>
                                    </select>
                                </label>
                            </div>
                        </div>
                    </div>
                    <!-- Sort -->   

                    <div class="row">
                        <div class="col-sm-12">
                            <table class="table table-bordered dataTable" id="dataTable" width="100%" cellspacing="0"
                                role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                <thead>
                                    <tr role="row">
                                        <th style="width: 67px">#</th>
                                        <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="1"
                                            colspan="1" aria-sort="ascending"
                                            aria-label="Name: activate to sort column descending" style="width: 197px;">
                                            Name</th>
                                        <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                            colspan="1" aria-label="Position: activate to sort column ascending"
                                            style="width: 295px;">Target</th>
                                        <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                            colspan="1" aria-label="Office: activate to sort column ascending"
                                            style="width: 143px;">Time Scan</th>
                                        <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                            colspan="1" aria-label="Age: activate to sort column ascending"
                                            style="width: 67px;">Scan Name</th>
                                        <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                            colspan="1" aria-label="Start date: activate to sort column ascending"
                                            style="width: 133px;">Scan Type</th>
                                        <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1"
                                            colspan="1" aria-label="Salary: activate to sort column ascending"
                                            style="width: 121px;">Critical Level</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in response %}
                                    <tr class="{{ loop.cycle('odd', 'even') }}">
                                        <td> {{loop.index}} </td>
                                        <td> <a href="{{item.link}}"> {{item.name}} </td>
                                        <td> {{item.hostname}} ({{item.target}}) </td>
                                        <td> {{item.time_scan}} </td>
                                        <td> <a href='/scan/detail/{{item.root_scan_id}}'> {{item.scan_name}} </a> </td>
                                        <td> {{item.scan_type}} </td>
                                        <td> <span class="btn btn-circle"
                                                style="background-color: {{item.cvss_color}}; color: black; padding: 5px">{{item.level}}</span>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock  %}